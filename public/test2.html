<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spotify Playlist Interaction</title>
</head>
<body>
    <h1>My Spotify Playlist</h1>

    <!-- Button to load the playlist -->
    <button id="loadPlaylistButton">Load Playlist</button>

    <!-- Container to display playlist tracks -->
    <div id="playlistContainer"></div>

    <!-- Embedded Spotify Player (oEmbed) -->
    <h2>Embedded Playlist</h2>
    <iframe id="spotifyEmbed" style="border-radius:12px" 
            src="https://open.spotify.com/embed/playlist/37i9dQZF1EpjVWXn5cmrp1?utm_source=generator" 
            width="100%" height="500" 
            frameBorder="0" 
            allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
            loading="lazy">
    </iframe>

    <!-- Include Spotify Web API JavaScript file -->
    <script src="./js/spotify-web-api.js"></script>

    <script>
        // Create an instance of the Spotify Web API
        const spotifyApi = new SpotifyWebApi();

        // Set your access token (retrieved from localStorage or elsewhere)
        spotifyApi.setAccessToken(localStorage.getItem('spotifyAccessToken'));

        // Function to fetch and display playlist tracks
        async function loadPlaylistTracks() {
            try {
                // Fetch a specific playlist's tracks
                const playlistId = '37i9dQZF1EpjVWXn5cmrp1'; // Example playlist ID
                const playlistData = await spotifyApi.getPlaylistTracks(playlistId);
                const playlistContainer = document.getElementById('playlistContainer');
                playlistContainer.innerHTML = ''; // Clear previous content

                // Loop through each track and display it
                playlistData.items.forEach((item, index) => {
                    const track = item.track;
                    const trackElement = document.createElement('div');
                    trackElement.innerHTML = `<strong>${index + 1}. ${track.name}</strong> by ${track.artists.map(artist => artist.name).join(', ')}`;
                    trackElement.style.cursor = 'pointer'; // Add hover pointer for interactivity

                    // Add click event listener to handle track interaction
                    trackElement.addEventListener('click', () => {
                        console.log(`Clicked on track: ${track.name}`);
                        // Perform some action when a track is clicked, e.g., display details or play the track using Spotify SDK
                        alert(`You clicked on: ${track.name}`);
                    });

                    playlistContainer.appendChild(trackElement);
                });
            } catch (error) {
                console.error('Error fetching playlist tracks:', error);
            }
        }

        // Add click event listener to the button to load the playlist tracks
        document.getElementById('loadPlaylistButton').addEventListener('click', loadPlaylistTracks);
    </script>
</body>
</html>
